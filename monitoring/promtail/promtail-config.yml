server:\n  http_listen_port: 9080\n  grpc_listen_port: 0\n\npositions:\n  filename: /tmp/positions.yaml\n\nclients:\n  - url: http://loki:3100/loki/api/v1/push\n\nscrape_configs:\n- job_name: containers\n  static_configs:\n    - targets:\n        - localhost\n      labels:\n        job: containerlogs\n        __path__: /var/log/pods/*/*/*.log # This path needs to be adjusted based on Docker log location if not Kubernetes\n  pipeline_stages:\n    - docker: {}\n    - match:\n        selector: \'{job=\"containerlogs\"}\'\n        stages:\n        - regex:\n            expression: \'^(?P<time>\\S+)\\s(?P<stream>stdout|stderr)\\s(?P<flags>\\S+)\\s(?P<content>.*)$\'\n        - labels:\n            stream: # sets a label \`stream\` from the named capture group previously defined\n        - timestamp:\n            source: time\n            format: RFC3339Nano\n        - output:\n            source: content\n\n# A simpler config for general docker container logs if the above is too complex for non-K8s\n- job_name: system\n  docker_sd_configs:\n    - host: unix:///var/run/docker.sock\n      refresh_interval: 5s\n  relabel_configs:\n    - source_labels: [\'__meta_docker_container_name\']\n      regex: \'.+/(.+)\'\n      target_label: \'container\'\n    - source_labels: [\'__meta_docker_container_log_stream\']\n      target_label: \'logstream\'\n    - source_labels: [\'__meta_docker_container_label_com_docker_compose_service\']\n      target_label: \'compose_service\' 